<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MR.T Cafe - Food Order</title>
  <style>
    /* ... (CSS is unchanged) ... */

    /* Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, rgba(0,0,0,0.7), rgba(0,0,0,0.5)), 
                  url('https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1600') center/cover fixed;
      min-height: 100vh;
      padding: 20px;
      padding-top: 80px;
      color: #333;
    }

    h1 {
      text-align: center;
      color: white;
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      animation: fadeInDown 1s ease-out;
    }

    .tagline {
      text-align: center;
      color: #ffd700;
      font-size: 1.2rem;
      margin-bottom: 30px;
      font-style: italic;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Floating Cart Button */
    .cart-float-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.5);
      z-index: 1000;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .cart-float-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 12px 32px rgba(102, 126, 234, 0.7);
    }


    .cart-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #dc3545;
      color: white;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: bold;
      border: 2px solid white;
    }

    /* Modals (Cart and Location) */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 2000;
        animation: fadeIn 0.3s ease;
        align-items: center;
        justify-content: center;
    }

    .modal.active {
        display: flex;
    }

    .modal-content {
        background: white;
        border-radius: 20px;
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }


    .modal-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 20px 20px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h2 {
      font-size: 1.5rem;
      margin: 0;
    }

    .close-modal {
      background: transparent;
      border: none;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    .close-modal:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: rotate(90deg);
    }
    
    /* Location Modal Specific Styles */
    #locationModal .modal-content {
        max-width: 350px;
        padding: 20px;
    }
    
    #locationModal .modal-content > h2 {
        color: #333;
        margin-bottom: 15px;
        text-align: center;
        font-size: 1.3rem;
    }
    
    #locationModal select, #locationModal input {
        width: 100%;
        padding: 10px;
        border: 2px solid #e1e5e9;
        border-radius: 8px;
        margin-bottom: 15px;
        transition: all 0.3s ease;
        background-color: white;
    }
    
    #locationModal label {
        font-weight: bold;
        color: #555;
        margin-bottom: 5px;
        display: block;
    }

    .location-actions {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        margin-top: 20px;
    }

    .location-actions button {
        flex-grow: 1;
        padding: 10px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
    }
    
    #cancelLocation {
        background: #f0f0f0;
        color: #333;
    }
    
    #confirmLocation {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
    }

    /* Cart Content Styles */
    .cart-body {
      padding: 20px;
    }

    .customer-info-modal {
      margin-bottom: 20px;
      border: 1px solid #eee;
      padding: 15px;
      border-radius: 10px;
      background-color: #f9f9f9;
    }

    .customer-info-modal label {
      display: block;
      font-weight: bold;
      color: #555;
      margin-bottom: 5px;
      font-size: 0.9rem;
    }

    .customer-info-modal input, .customer-info-modal select {
      width: 100%;
      padding: 10px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      margin-bottom: 15px;
      transition: all 0.3s ease;
      background-color: white;
    }

    .mobile-input-group {
      transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
      overflow: hidden;
      max-height: 0;
      opacity: 0;
    }

    .mobile-input-group.show {
        max-height: 100px; 
        opacity: 1;
    }

    .delivery-charge-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-top: 1px solid #eee;
        font-weight: bold;
        color: #dc3545;
        display: none; 
    }
    
    /* Cart Item Styles */
    .cart-items-list {
      margin: 20px 0;
      max-height: 300px;
      overflow-y: auto;
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #eee;
    }

    .cart-item:last-child {
      border-bottom: none;
    }
    
    .quantity-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .quantity-btn {
      background: #dc3545;
      color: white;
      border: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .quantity-btn:hover {
      background: #c82333;
      transform: scale(1.1);
    }

    .quantity-btn.plus {
      background: #28a745;
    }

    .quantity-btn.plus:hover {
      background: #218838;
    }

    .cart-total {
      font-size: 1.5rem;
      font-weight: bold;
      color: #333;
      text-align: center;
      margin: 20px 0;
      padding: 15px;
      background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
      border-radius: 10px;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      flex-direction: column;
      margin-top: 20px;
    }
    
    .action-buttons button {
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
    }

    .send-btn {
      background: linear-gradient(135deg, #28a745, #20c997);
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }
    
    .pdf-btn {
      background: linear-gradient(135deg, #6c757d, #495057);
      box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
    }

    /* Main Page Customer Info Layout (Updated) */
    .customer-info {
        background: rgba(255, 255, 255, 0.95);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        animation: fadeInUp 1s ease-out 0.2s both;
        display: flex;
        gap: 15px;
        align-items: center;
        flex-wrap: wrap;
    }

    .customer-info-field {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-shrink: 0;
    }
    
    /* Input Container for Table/Room and Contact */
    .customer-details-container {
        display: flex;
        flex-grow: 1;
        gap: 15px;
        align-items: center;
        flex-wrap: wrap;
    }

    .customer-info label {
      font-weight: bold;
      color: #555;
      white-space: nowrap;
    }

    .customer-info input, .customer-info select {
      padding: 10px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      transition: all 0.3s ease;
      min-width: 150px;
      background-color: white;
    }
    
    /* New Button for Delivery Location */
    .delivery-location-btn {
        background: linear-gradient(135deg, #764ba2, #667eea);
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(118, 75, 162, 0.3);
        flex-shrink: 0;
    }

    .delivery-location-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(118, 75, 162, 0.4);
    }
    
    /* Highlight the delivery button if a hostel is selected */
    .delivery-location-btn.selected {
        background: linear-gradient(135deg, #28a745, #20c997);
    }
    
    /* Contact Input visibility in main container */
    .mobile-input-group-main {
        transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
        overflow: hidden;
        max-height: 0;
        opacity: 0;
    }
    .mobile-input-group-main.show {
        max-height: 100px;
        opacity: 1;
    }
    
    /* --- Search & Menu Styles --- */
    
    .search-container {
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      animation: fadeInUp 1s ease-out 0.3s both;
    }

    .search-box {
      position: relative;
      width: 100%;
    }

    .search-box input {
      width: 100%;
      padding: 15px 50px 15px 20px;
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      font-size: 1.1rem;
      transition: all 0.3s ease;
    }
    
    .search-box input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .search-icon {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.3rem;
      color: #667eea;
      pointer-events: none;
    }
    
    .clear-search {
      position: absolute;
      right: 55px;
      top: 50%;
      transform: translateY(-50%);
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      cursor: pointer;
      font-size: 1rem;
      display: none;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .clear-search.show {
      display: flex;
    }

    .category {
      background: rgba(255, 255, 255, 0.95);
      margin-bottom: 30px;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      animation: fadeInUp 1s ease-out 0.4s both;
    }
    
    /* NEW: Styling for API fetched Categories */
    .category.new-category h2 {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .category h2 {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      margin: 0;
      font-size: 1.5rem;
      text-align: center;
    }

    .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #f0f0f0;
      transition: all 0.3s ease;
    }

    .item:hover {
      background-color: #f8f9ff;
      transform: translateX(5px);
    }

    .item:last-child {
      border-bottom: none;
    }

    .item-name {
      font-weight: 500;
      font-size: 1.1rem;
      color: #333;
    }

    .item button {
      background: linear-gradient(135deg, #28a745, #20c997);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }

    .item button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }

    .item button:active {
      transform: translateY(0);
    }
    
    .category.hidden {
      display: none;
    }

    .item.hidden {
      display: none;
    }

    .item.highlight {
      background-color: #fff3cd;
      border-left: 4px solid #ffc107;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .status-message {
      margin-top: 10px;
      padding: 10px;
      border-radius: 5px;
      text-align: center;
      font-weight: bold;
    }

    .success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .toast {
      position: fixed;
      top: 100px;
      right: 20px;
      background: linear-gradient(135deg, #28a745, #20c997);
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 8px 24px rgba(40, 167, 69, 0.4);
      z-index: 3000;
      animation: slideInRight 0.5s ease, slideOutRight 0.5s ease 2.5s;
      font-weight: bold;
      display: none;
    }

    .toast.show {
      display: block;
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(100px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes slideOutRight {
      from {
        opacity: 1;
        transform: translateX(0);
      }
      to {
        opacity: 0;
        transform: translateX(100px);
      }
    }


    @media (max-width: 768px) {
      body {
        padding: 10px;
        padding-top: 80px;
      }

      .customer-info {
        flex-direction: column;
        align-items: stretch;
      }
      
      .delivery-location-btn {
          width: 100%;
          margin-bottom: 10px;
      }
      
      .customer-details-container {
        flex-direction: column;
        gap: 10px;
        width: 100%;
      }

      .customer-info-field {
        width: 100%;
        display: block;
      }

      .customer-info input, .customer-info select {
        width: 100%;
        min-width: auto;
      }

      .item {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }

      .cart-modal-content {
        width: 95%;
      }
      
      .toast {
        right: 10px;
        left: 10px;
      }
    }
  </style>
</head>
<body>
  <button class="cart-float-btn" onclick="toggleCart()">
    üõí
    <span class="cart-badge" id="cartBadge">0</span>
  </button>

  <div class="toast" id="toast">‚úÖ Added to cart!</div>
  
  <div class="modal" id="locationModal">
    <div class="modal-content">
        <h2>Select Delivery Location</h2>
        
        <label for="hostelNameSelector" style="color: #667eea; font-size: 1.1rem;">Select Hostel Name:</label>
        <select id="hostelNameSelector">
            <option value="Table Order">Canteen Dine-In (No Delivery)</option>
            <option value="Rukmani - 1">Rukmani - 1</option>
            <option value="Rukmani - 2">Rukmani - 2</option>
            <option value="MBBS Girls Gate - 1">MBBS Girls Gate - 1</option>
            <option value="MBBS Girls Gate - 2">MBBS Girls Gate - 2</option>
            <option value="Old Boys Hostel">Old Boys Hostel</option>
            <option value="P.G Boys Hostel">P.G Boys Hostel</option>
            <option value="RAMAN House">RAMAN House</option>
            <option value="Sushrut Hostel">Sushrut Hostel</option>
            <option value="Kalpuna Hostel">Kalpuna Hostel</option>
            <option value="Rani laxmi Bai Hostel">Rani laxmi Bai Hostel</option>
            </select>

        
        <label for="contactNumberLocation">Contact Number (10 digits):</label>
        <input type="tel" id="contactNumberLocation" placeholder="Contact Number (Mandatory for Delivery)" maxlength="10">

        <div class="location-actions">
            <button id="cancelLocation" onclick="toggleLocationModal()">Cancel</button>
            <button id="confirmLocation" onclick="confirmDeliveryLocation()">Confirm Location</button>
        </div>
    </div>
  </div>


  <div class="modal" id="cartModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üõí Your Order</h2>
        <button class="close-modal" onclick="toggleCart()">√ó</button>
      </div>
      <div class="cart-body">
        <div class="customer-info-modal">
          <input type="hidden" id="hotelNameModal"> 
          <input type="hidden" id="tableNumberModal">
          <input type="hidden" id="contactNumberModal">
          
          <label>Location:</label>
          <input type="text" id="locationDisplayInCart" readonly style="font-weight: bold; margin-bottom: 10px;">

          <label id="tableRoomLabelModal">Table/Room Number:</label>
          <input type="text" id="tableNumberDisplayInCart" readonly style="margin-bottom: 10px;">
          
          <div class="mobile-input-group" id="contactGroupModal">
            <label>Contact Number (Delivery):</label>
            <input type="text" id="contactNumberDisplayInCart" readonly>
          </div>
        </div>

        <div class="cart-items-list" id="cartItemsList">
          <div class="empty-cart">
            <div class="empty-cart-icon">üõí</div>
            <p>Your cart is empty</p>
            <p style="font-size: 0.9rem; margin-top: 5px;">Add items to get started!</p>
          </div>
        </div>
        
        <div class="delivery-charge-row" id="deliveryChargeRow">
            <span>Delivery Charge:</span>
            <span>‚Çπ10</span> </div>
        
        <div class="cart-total" id="cartTotal">Grand Total: ‚Çπ0</div>

        <div class="action-buttons">
          <button class="send-btn" onclick="sendSMS()">‚úÖ PLACE ORDER</button>
          <button class="pdf-btn" onclick="downloadPDF()">üßæ Download Bill</button>
        </div>
        <div id="statusMessage"></div>
      </div>
    </div>
  </div>

  

  <h1>üçΩÔ∏è MR.T Cafe</h1>
  <p class="tagline">A Taste of Home, Away from Home</p>
  <p class="tagline"> Contect Number - 9696857466</p>

  <div class="customer-info">
    <button class="delivery-location-btn" id="setDeliveryLocationBtn" onclick="toggleLocationModal()">
      Set Delivery Location
    </button>
    
    <div class="customer-details-container">
        <div class="customer-info-field">
            <label id="tableRoomLabel">Table Number:</label>
            <input type="text" id="tableNumber" placeholder="Enter Table Number">
        </div>
        
        <div class="customer-info-field mobile-input-group-main" id="contactGroupMain">
            <label>Contact Number:</label>
            <input type="tel" id="contactNumber" placeholder="Enter Contact Number (10 digits)" maxlength="10">
        </div>
    </div>
    
    <input type="hidden" id="hotelName" value="Table Order"> 
  </div>

  <div class="search-container">
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Search for food items..." autocomplete="off">
      <button class="clear-search" id="clearSearch" onclick="clearSearch()">√ó</button>
      <span class="search-icon">üîç</span>
    </div>
    <div class="search-results-info" id="searchResultsInfo"></div>
  </div>
  
  <div class="category">
    <h2>‚òï Chai Shai</h2>
    <div class="item"><span class="item-name">Adrak Tea - ‚Çπ15</span><button onclick="addToCart('Adrak Tea', 15)">Add</button></div>
    <div class="item"><span class="item-name">Masala Tea - ‚Çπ20</span><button onclick="addToCart('Masala Tea', 20)">Add</button></div>
    <div class="item"><span class="item-name">Cinnamon Tea - ‚Çπ25</span><button onclick="addToCart('Cinnamon Tea', 25)">Add</button></div>
  </div>

  <div class="category">
    <h2>‚òï Coffee</h2>
    <div class="item"><span class="item-name">Black Coffee - ‚Çπ15</span><button onclick="addToCart('Black Coffee', 15)">Add</button></div>
    <div class="item"><span class="item-name">Classic Coffee - ‚Çπ25</span><button onclick="addToCart('Classic Coffee', 25)">Add</button></div>
    <div class="item"><span class="item-name">Chocolate Coffee - ‚Çπ40</span><button onclick="addToCart('Chocolate Coffee', 40)">Add</button></div>
    <div class="item"><span class="item-name">Hot Chocolate - ‚Çπ40</span><button onclick="addToCart('Hot Chocolate', 40)">Add</button></div>
    <div class="item"><span class="item-name">Cold Coffee - ‚Çπ89</span><button onclick="addToCart('Cold Coffee', 89)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•§ Shakes</h2>
    <div class="item"><span class="item-name">Lassi - ‚Çπ50</span><button onclick="addToCart('Lassi', 50)">Add</button></div>
    <div class="item"><span class="item-name">Butter-Scotch - ‚Çπ79</span><button onclick="addToCart('Butter Scotch', 79)">Add</button></div>
    <div class="item"><span class="item-name">Vanilla - ‚Çπ79</span><button onclick="addToCart('Vanilla', 79)">Add</button></div>
    <div class="item"><span class="item-name">Chocolate - ‚Çπ79</span><button onclick="addToCart('Chocolate', 79)">Add</button></div>
    <div class="item"><span class="item-name">Strawberry - ‚Çπ79</span><button onclick="addToCart('Strawberry', 79)">Add</button></div>
    <div class="item"><span class="item-name">Oreo - ‚Çπ89</span><button onclick="addToCart('Oreo', 89)">Add</button></div>
    <div class="item"><span class="item-name">Kit-Kat - ‚Çπ89</span><button onclick="addToCart('Kit-Kat', 89)">Add</button></div>
    <div class="item"><span class="item-name">Brownie Shake - ‚Çπ109</span><button onclick="addToCart('Brownie Shake', 109)">Add</button></div>
    <div class="item"><span class="item-name">Mango Shake - ‚Çπ60</span><button onclick="addToCart('Mango Shake', 60)">Add</button></div>
  </div>

  <div class="category">
    <h2>üßä Ice Tea</h2>
    <div class="item"><span class="item-name">Lemon Ice Tea - ‚Çπ59</span><button onclick="addToCart('Lemon Ice Tea', 59)">Add</button></div>
    <div class="item"><span class="item-name">Peach Ice Tea - ‚Çπ59</span><button onclick="addToCart('Peach Ice Tea', 59)">Add</button></div>
    <div class="item"><span class="item-name">Mint Ice Tea - ‚Çπ59</span><button onclick="addToCart('Mint Ice Tea', 59)">Add</button></div>
  </div>

  <div class="category">
    <h2>üπ†Mocktails</h2>
    <div class="item"><span class="item-name">Virgin Mojito - ‚Çπ59</span><button onclick="addToCart('Virgin Mojito', 59)">Add</button></div>
    <div class="item"><span class="item-name">Blue Lagoon - ‚Çπ59</span><button onclick="addToCart('Blue Lagoon', 59)">Add</button></div>
    <div class="item"><span class="item-name">Kala Khatta - ‚Çπ59</span><button onclick="addToCart('Kala Khatta', 59)">Add</button></div>
    <div class="item"><span class="item-name">Watermelon - ‚Çπ59</span><button onclick="addToCart('Watermelon', 59)">Add</button></div>
    <div class="item"><span class="item-name">Tangy Mango - ‚Çπ59</span><button onclick="addToCart('Tangy Mango', 59)">Add</button></div>
    <div class="item"><span class="item-name">Tamarind - ‚Çπ59</span><button onclick="addToCart('Tamarind', 59)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•§ Soft Drinks</h2>
    <div class="item"><span class="item-name">Water - ‚Çπ20</span><button onclick="addToCart('Water', 20)">Add</button></div>
    <div class="item"><span class="item-name">Cold Drink - ‚Çπ20</span><button onclick="addToCart('Cold Drink', 20)">Add</button></div>
    <div class="item"><span class="item-name">Masala Cold Drink - ‚Çπ35</span><button onclick="addToCart('Masala Drink', 35)">Add</button></div>
    <div class="item"><span class="item-name">Masala Lemonade - ‚Çπ50</span><button onclick="addToCart('Masala Lemonade', 50)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü≤†Soups</h2>
    <div class="item"><span class="item-name">Sweet Corn Soup - ‚Çπ79</span><button onclick="addToCart('Sweet Corn Soup', 79)">Add</button></div>
    <div class="item"><span class="item-name">Hot & Sour Soup - ‚Çπ79</span><button onclick="addToCart('Hot & Sour Soup', 79)">Add</button></div>
    <div class="item"><span class="item-name">Veggie Soup - ‚Çπ79</span><button onclick="addToCart('Veggie Soup', 79)">Add</button></div>
    <div class="item"><span class="item-name">Manchow Soup - ‚Çπ99</span><button onclick="addToCart('Manchow Soup', 99)">Add</button></div>
    <div class="item"><span class="item-name">Mex Chilli Beans - ‚Çπ99</span><button onclick="addToCart('Mex Chilli Beans', 99)">Add</button></div>
  </div>

  <div class="category">
    <h2>üú†Maggie</h2>
    <div class="item"><span class="item-name">Veg Maggie - ‚Çπ55</span><button onclick="addToCart('Veg Maggie', 55)">Add</button></div>
    <div class="item"><span class="item-name">Peri Peri Maggie - ‚Çπ69</span><button onclick="addToCart('Peri Peri Maggie', 69)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Maggie - ‚Çπ79</span><button onclick="addToCart('Paneer Maggie', 79)">Add</button></div>
    <div class="item"><span class="item-name">Cheese Maggie - ‚Çπ99</span><button onclick="addToCart('Cheese Maggie', 99)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•™ Sandwiches</h2>
    <div class="item"><span class="item-name">Veg Sandwich - ‚Çπ75</span><button onclick="addToCart('Veg Sandwich', 75)">Add</button></div>
    <div class="item"><span class="item-name">Cheese Veg - ‚Çπ89</span><button onclick="addToCart('Cheese Veg', 89)">Add</button></div>
    <div class="item"><span class="item-name">Cheese Corn - ‚Çπ99</span><button onclick="addToCart('Cheese Corn', 99)">Add</button></div>
    <div class="item"><span class="item-name">Cheese Paneer - ‚Çπ99</span><button onclick="addToCart('Cheese Paneer', 99)">Add</button></div>
    <div class="item"><span class="item-name">Spicy Paneer - ‚Çπ89</span><button onclick="addToCart('Spicy Paneer', 89)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•ü Momos</h2>
    <div class="item"><span class="item-name">Steamed Veg - ‚Çπ55</span><button onclick="addToCart('Steamed Veg', 55)">Add</button></div>
    <div class="item"><span class="item-name">Fried Veg - ‚Çπ69</span><button onclick="addToCart('Fried Veg', 69)">Add</button></div>
    <div class="item"><span class="item-name">Tandoori Momos - ‚Çπ79</span><button onclick="addToCart('Tandoori Momos', 79)">Add</button></div>
    <div class="item"><span class="item-name">Kurkure Momos - ‚Çπ79</span><button onclick="addToCart('Kurkure Momos', 79)">Add</button></div>
    <div class="item"><span class="item-name">Peri Peri Momos - ‚Çπ79</span><button onclick="addToCart('Peri Peri Momos', 79)">Add</button></div>
    <div class="item"><span class="item-name">Veggie Crunch Roll - ‚Çπ55</span><button onclick="addToCart('Veggie Crunch Roll', 55)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçî Burger</h2>
    <div class="item"><span class="item-name">Veggie Burger - ‚Çπ59</span><button onclick="addToCart('Veggie Burger', 59)">Add</button></div>
    <div class="item"><span class="item-name">Spicy Burger - ‚Çπ69</span><button onclick="addToCart('Spicy Burger', 69)">Add</button></div>
    <div class="item"><span class="item-name">Tandoori Burger - ‚Çπ69</span><button onclick="addToCart('Tandoori Burger', 69)">Add</button></div>
    <div class="item"><span class="item-name">Cheese Loaded - ‚Çπ89</span><button onclick="addToCart('Cheese Loaded', 89)">Add</button></div>
  </div>

  <div class="category">
    <h2>üåΩ Corn</h2>
    <div class="item"><span class="item-name">Sweet Corn - ‚Çπ69</span><button onclick="addToCart('Sweet Corn', 69)">Add</button></div>
    <div class="item"><span class="item-name">Veggie Corn - ‚Çπ79</span><button onclick="addToCart('Veggie Corn', 79)">Add</button></div>
    <div class="item"><span class="item-name">Crispy Corn - ‚Çπ109</span><button onclick="addToCart('Crispy Corn', 109)">Add</button></div>
    <div class="item"><span class="item-name">Vada pav - ‚Çπ40</span><button onclick="addToCart('Vada pav', 89)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçù Pasta</h2>
    <div class="item"><span class="item-name">White Sauce - ‚Çπ119</span><button onclick="addToCart('White Sauce', 119)">Add</button></div>
    <div class="item"><span class="item-name">Red Sauce - ‚Çπ99</span><button onclick="addToCart('Red Sauce', 99)">Add</button></div>
    <div class="item"><span class="item-name">Pink Sauce - ‚Çπ109</span><button onclick="addToCart('Pink Sauce', 109)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçü Fries</h2>
    <div class="item"><span class="item-name">Crunchy French Fries - ‚Çπ69</span><button onclick="addToCart('Crunchy French Fries', 69)">Add</button></div>
    <div class="item"><span class="item-name">Peri Peri Fries - ‚Çπ79</span><button onclick="addToCart('Peri Peri Fries', 79)">Add</button></div>
    <div class="item"><span class="item-name">Cheese Fries - ‚Çπ89</span><button onclick="addToCart('Cheese Fries', 89)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçï Pizza</h2>
    <div class="item"><span class="item-name">Queen Margherita - ‚Çπ149</span><button onclick="addToCart('Queen Margherita', 149)">Add</button></div>
    <div class="item"><span class="item-name">Double Topping - ‚Çπ159</span><button onclick="addToCart('Double Topping', 159)">Add</button></div>
    <div class="item"><span class="item-name">Veggie Fresh - ‚Çπ179</span><button onclick="addToCart('Veggie Fresh', 179)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Treat - ‚Çπ199</span><button onclick="addToCart('Paneer Treat', 199)">Add</button></div>
    <div class="item"><span class="item-name">Farm Fresh - ‚Çπ249</span><button onclick="addToCart('Farm Fresh', 249)">Add</button></div>
    <div class="item"><span class="item-name">Garlic Bread - ‚Çπ79</span><button onclick="addToCart('Garlic Bread', 79)">Add</button></div>
  </div>

  <div class="category">
    <h2>üåØ Wraps</h2>
    <div class="item"><span class="item-name">Aalu Tikki Wrap - ‚Çπ79</span><button onclick="addToCart('Aalu Tikki Wrap', 79)">Add</button></div>
    <div class="item"><span class="item-name">Jalapeno Veggie - ‚Çπ79</span><button onclick="addToCart('Jalapeno Veggie', 79)">Add</button></div>
    <div class="item"><span class="item-name">Tandoori Veggie - ‚Çπ89</span><button onclick="addToCart('Tandoori Veggie', 89)">Add</button></div>
    <div class="item"><span class="item-name">Tandoori Paneer - ‚Çπ99</span><button onclick="addToCart('Tandoori Paneer', 99)">Add</button></div>
    <div class="item"><span class="item-name">Cheese Veggie - ‚Çπ99</span><button onclick="addToCart('Cheese Veggie', 99)">Add</button></div>
  </div>

  <div class="category">
    <h2>üåÖ Morning Masala</h2>
    <div class="item"><span class="item-name">Samosa (2 Pcs) - ‚Çπ25</span><button onclick="addToCart('Samosa (2 Pcs)', 25)">Add</button></div>
    <div class="item"><span class="item-name">2 Samosa with Chola - ‚Çπ35</span><button onclick="addToCart('2 Samosa with Chola', 35)">Add</button></div>
    <div class="item"><span class="item-name">2 Khasta - ‚Çπ30</span><button onclick="addToCart('2 Khasta', 30)">Add</button></div>
    <div class="item"><span class="item-name">Puri Sabji - ‚Çπ50</span><button onclick="addToCart('Puri Sabji', 50)">Add</button></div>
    <div class="item"><span class="item-name">Chole Bhature - ‚Çπ60</span><button onclick="addToCart('Chole Bhature', 60)">Add</button></div>
    <div class="item"><span class="item-name">Pav Bhaji - ‚Çπ80</span><button onclick="addToCart('Pav Bhaji', 80)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü´ì Parantha</h2>
    <div class="item"><span class="item-name">Aalu Parantha - ‚Çπ50</span><button onclick="addToCart('Aalu Parantha', 50)">Add</button></div>
    <div class="item"><span class="item-name">Pyaj Parantha - ‚Çπ60</span><button onclick="addToCart('Pyaj Parantha', 60)">Add</button></div>
    <div class="item"><span class="item-name">Gobhi Parantha - ‚Çπ60</span><button onclick="addToCart('Gobhi Parantha', 60)">Add</button></div>
    <div class="item"><span class="item-name">Mix Parantha - ‚Çπ70</span><button onclick="addToCart('Mix Parantha', 70)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Parantha - ‚Çπ75</span><button onclick="addToCart('Paneer Parantha', 75)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•ò Pakoda</h2>
    <div class="item"><span class="item-name">Pyaj Pakoda - ‚Çπ69</span><button onclick="addToCart('Pyaj Pakoda', 69)">Add</button></div>
    <div class="item"><span class="item-name">Mix Veg Pakoda - ‚Çπ60</span><button onclick="addToCart('Mix Veg Pakoda', 60)">Add</button></div>
    <div class="item"><span class="item-name">Bread Pakoda - ‚Çπ20</span><button onclick="addToCart('Bread Pakoda', 20)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Pakoda - ‚Çπ99</span><button onclick="addToCart('Paneer Pakoda', 99)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçõ Indian Khajana</h2>
    <div class="item"><span class="item-name">Dal Tadka - ‚Çπ89</span><button onclick="addToCart('Dal Tadka', 89)">Add</button></div>
    <div class="item"><span class="item-name">Dal Fry - ‚Çπ99</span><button onclick="addToCart('Dal Fry', 99)">Add</button></div>
    <div class="item"><span class="item-name">Jerra Aalu - ‚Çπ99</span><button onclick="addToCart('Jerra Aalu', 99)">Add</button></div>
    <div class="item"><span class="item-name">Chana Masala - ‚Çπ119</span><button onclick="addToCart('Chana Masala', 119)">Add</button></div>
    <div class="item"><span class="item-name">Aalu Mushroom - ‚Çπ119</span><button onclick="addToCart('Aalu Mushroom', 119)">Add</button></div>
    <div class="item"><span class="item-name">Rajma - ‚Çπ119</span><button onclick="addToCart('Rajma', 119)">Add</button></div>
    <div class="item"><span class="item-name">Mix Veg - ‚Çπ129</span><button onclick="addToCart('Mix Veg', 129)">Add</button></div>
    <div class="item"><span class="item-name">Matar Paneer - ‚Çπ149</span><button onclick="addToCart('Matar Paneer', 149)">Add</button></div>
    <div class="item"><span class="item-name">Matar Mushroom - ‚Çπ159</span><button onclick="addToCart('Matar Mushroom', 159)">Add</button></div>
    <div class="item"><span class="item-name">Kadhai Paneer - ‚Çπ169</span><button onclick="addToCart('Kadhai Paneer', 169)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Do Pyaza - ‚Çπ169</span><button onclick="addToCart('Paneer Do Pyaza', 169)">Add</button></div>
    <div class="item"><span class="item-name">Handi Paneer - ‚Çπ169</span><button onclick="addToCart('Handi Paneer', 169)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Butter Masala - ‚Çπ179</span><button onclick="addToCart('Paneer Butter Masala', 179)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Masala - ‚Çπ159</span><button onclick="addToCart('Paneer Masala', 159)">Add</button></div>
    <div class="item"><span class="item-name">Shahi Paneer - ‚Çπ189</span><button onclick="addToCart('Shahi Paneer', 189)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçö Rice</h2>
    <div class="item"><span class="item-name">Plain Rice - ‚Çπ99</span><button onclick="addToCart('Plain Rice', 99)">Add</button></div>
    <div class="item"><span class="item-name">Jeera Rice - ‚Çπ109</span><button onclick="addToCart('Jeera Rice', 109)">Add</button></div>
    <div class="item"><span class="item-name">Butter Rice - ‚Çπ109</span><button onclick="addToCart('Butter Rice', 109)">Add</button></div>
    <div class="item"><span class="item-name">Veg Pulao - ‚Çπ119</span><button onclick="addToCart('Veg Pulao', 119)">Add</button></div>
    <div class="item"><span class="item-name">Veg Biryani - ‚Çπ129</span><button onclick="addToCart('Veg Biryani', 129)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçû Bread</h2>
    <div class="item"><span class="item-name">Tawa Roti - ‚Çπ10</span><button onclick="addToCart('Tawa Roti', 10)">Add</button></div>
    <div class="item"><span class="item-name">Butter Roti - ‚Çπ15</span><button onclick="addToCart('Butter Roti', 15)">Add</button></div>
    <div class="item"><span class="item-name">Puri - ‚Çπ15</span><button onclick="addToCart('Puri', 15)">Add</button></div>
    <div class="item"><span class="item-name">Plain Parantha - ‚Çπ15</span><button onclick="addToCart('Plain Parantha', 15)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•ó Salads & Raita</h2>
    <div class="item"><span class="item-name">Green Salad - ‚Çπ59</span><button onclick="addToCart('Green Salad', 59)">Add</button></div>
        <div class="item"><span class="item-name">Veg Raita - ‚Çπ49</span><button onclick="addToCart('Veg Raita', 49)">Add</button></div>
        <div class="item"><span class="item-name">Boondi Raita - ‚Çπ49</span><button onclick="addToCart('Boondi Raita', 49)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçú Noodles</h2>
    <div class="item"><span class="item-name">Desi Noodles - ‚Çπ99</span><button onclick="addToCart('Desi Noodles', 99)">Add</button></div>
    <div class="item"><span class="item-name">Veg Hakka Noodles - ‚Çπ129</span><button onclick="addToCart('Veg Hakka Noodles', 129)">Add</button></div>
    <div class="item"><span class="item-name">Schezwan Noodles - ‚Çπ119</span><button onclick="addToCart('Schezwan Noodles', 119)">Add</button></div>
    <div class="item"><span class="item-name">Chilli Garlic Noodles - ‚Çπ119</span><button onclick="addToCart('Chilli Garlic Noodles', 119)">Add</button></div>
    <div class="item"><span class="item-name">Singapuria Noodles - ‚Çπ129</span><button onclick="addToCart('Singapuria Noodles', 129)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçö Chinese Rice</h2>
    <div class="item"><span class="item-name">Fried Rice - ‚Çπ109</span><button onclick="addToCart('Fried Rice', 109)">Add</button></div>
    <div class="item"><span class="item-name">Chilli Garlic Rice - ‚Çπ119</span><button onclick="addToCart('Chilli Garlic Rice', 119)">Add</button></div>
    <div class="item"><span class="item-name">Schezwan Fried Rice - ‚Çπ119</span><button onclick="addToCart('Schezwan Fried Rice', 119)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Fried Rice - ‚Çπ129</span><button onclick="addToCart('Paneer Fried Rice', 129)">Add</button></div>
  </div>

  <div class="category">
    <h2>üå∂Ô∏è Flavors of Kanpur</h2>
    <div class="item"><span class="item-name">Chilli Potato - ‚Çπ109</span><button onclick="addToCart('Chilli Potato', 109)">Add</button></div>
    <div class="item"><span class="item-name">Manchurian - ‚Çπ119</span><button onclick="addToCart('Manchurian', 119)">Add</button></div>
    <div class="item"><span class="item-name">Honey Chilli Potato - ‚Çπ129</span><button onclick="addToCart('Honey Chilli Potato', 129)">Add</button></div>
    <div class="item"><span class="item-name">Chilli Paneer - ‚Çπ139</span><button onclick="addToCart('Chilli Paneer', 139)">Add</button></div>
    <div class="item"><span class="item-name">Kung Pao Paneer - ‚Çπ149</span><button onclick="addToCart('Kung Pao Paneer', 149)">Add</button></div>
    <div class="item"><span class="item-name">Chinese bhel - ‚Çπ109</span><button onclick="addToCart('Chinese bhel', 109)">Add</button></div>
    <div class="item"><span class="item-name">Gravy momos - ‚Çπ99</span><button onclick="addToCart('Gravy¬†momos', 99)">Add</button></div>
  </div>

  <div class="category">
    <h2>üç± Rice Meal</h2>
    <div class="item"><span class="item-name">Dal Rice - ‚Çπ89</span><button onclick="addToCart('Dal Rice', 89)">Add</button></div>
    <div class="item"><span class="item-name">Chola Rice - ‚Çπ99</span><button onclick="addToCart('Chola Rice', 99)">Add</button></div>
    <div class="item"><span class="item-name">Rajma Rice - ‚Çπ109</span><button onclick="addToCart('Rajma Rice', 109)">Add</button></div>
  </div>

  <div class="category">
    <h2>üçΩÔ∏è Thali</h2>
    <div class="item"><span class="item-name">Eco Thali (4 Roti + Mix Veg + Dal + Rice + Salad) - ‚Çπ149</span><button onclick="addToCart('Eco Thali', 149)">Add</button></div>
    <div class="item"><span class="item-name">Deluxe Thali (4 Roti + Paneer Sabji + Dal + Rice + Salad) - ‚Çπ179</span><button onclick="addToCart('Deluxe Thali', 179)">Add</button></div>
  </div>

  <div class="category">
    <h2>üç± Eco Meal</h2>
    <div class="item"><span class="item-name">4 Roti With Paneer of the Day + Salad - ‚Çπ109</span><button onclick="addToCart('4 Roti With Paneer + Salad', 109)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•° Chinese Combo</h2>
    <div class="item"><span class="item-name">Noodles with Manchurian - ‚Çπ129</span><button onclick="addToCart('Noodles with Manchurian', 129)">Add</button></div>
    <div class="item"><span class="item-name">Noodles with Chilli Paneer - ‚Çπ149</span><button onclick="addToCart('Noodles with Chilli Paneer', 149)">Add</button></div>
    <div class="item"><span class="item-name">Fried Rice with Manchurian - ‚Çπ129</span><button onclick="addToCart('Fried Rice with Manchurian', 129)">Add</button></div>
    <div class="item"><span class="item-name">Fried Rice with Chilli Paneer - ‚Çπ149</span><button onclick="addToCart('Fried Rice with Chilli Paneer', 149)">Add</button></div>
  </div>

  <div class="category">
    <h2>ü•° South Indian</h2>
    <div class="item"><span class="item-name">Plain Dosa - ‚Çπ60</span><button onclick="addToCart('Plain Dosa', 60)">Add</button></div>
    <div class="item"><span class="item-name">Masala Dosa -70</span><button onclick="addToCart('Masala Dosa', 70)">Add</button></div>
    <div class="item"><span class="item-name">Paneer masala dosa - ‚Çπ90</span><button onclick="addToCart('Paneer masala dosa', 90)">Add</button></div>
    <div class="item"><span class="item-name">Paneer Dosa - ‚Çπ100</span><button onclick="addToCart('Paneer Dosa', 100)">Add</button></div>
    <div class="item"><span class="item-name">Idli¬†Smaha - ‚Çπ60</span><button onclick="addToCart('Idli¬†Smaha', 60)">Add</button></div>
  </div>


  <div class="category">
    <h2>üç∞ Desserts</h2>
    <div class="item"><span class="item-name">Ice Cream - ‚Çπ49</span><button onclick="addToCart('Ice Cream', 49)">Add</button></div>
    <div class="item"><span class="item-name">Brownie - ‚Çπ75</span><button onclick="addToCart('Brownie', 75)">Add</button></div>
    <div class="item"><span class="item-name">Brownie with Ice Cream - ‚Çπ99</span><button onclick="addToCart('Brownie with Ice Cream', 99)">Add</button></div>
  </div>
  <div id="newMenuItemsContainer"></div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  
  <script>
   let cart = {};
    let total = 0;
    const DELIVERY_CHARGE = 10; // UPDATED: Delivery charge changed from 20 to 10
    const MENU_API_URL = 'https://mrt-cafe-api.onrender.com/api/menu'; // Menu API Endpoint
    
    // Global variable for AudioContext
    let audioContext;
    let audioReady = false;
    
    // --- NEW: Function to Fetch and Render API Menu Items ---
    function fetchMenuDataAndRender() {
        fetch(MENU_API_URL)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch new menu items.');
                }
                return response.json();
            })
            .then(data => {
                renderNewMenuItems(data);
            })
            .catch(error => {
                console.error('Error fetching dynamic menu:', error);
                // Optionally show a message to the user
                const container = document.getElementById('newMenuItemsContainer');
            });
    }

    function renderNewMenuItems(items) {
        const container = document.getElementById('newMenuItemsContainer');
        container.innerHTML = '';
        
        // Group items by category
        const categories = items.reduce((acc, item) => {
            if (!acc[item.category]) {
                acc[item.category] = {
                    emoji: item.emoji || '‚≠ê', // Use saved emoji or default
                    items: []
                };
            }
            acc[item.category].items.push(item);
            return acc;
        }, {});
        
        // Render each category group
        for (const catName in categories) {
            const catData = categories[catName];
            
            const categoryDiv = document.createElement('div');
            // Add a special class to style dynamically added categories differently
            categoryDiv.className = 'category new-category'; 
            categoryDiv.innerHTML = `<h2>${catData.emoji} ${catName} (New)</h2>`;
            
            catData.items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'item';
                itemDiv.innerHTML = `
                    <span class="item-name">${item.name} - ‚Çπ${item.price}</span>
                    <button onclick="addToCart('${item.name}', ${item.price})">Add</button>
                `;
                categoryDiv.appendChild(itemDiv);
            });
            
            container.appendChild(categoryDiv);
        }
    }
    // --- END NEW FUNCTION ---


    // Initialize AudioContext on user interaction
    function initAudioContext() {
        if (!audioReady) {
            try {
                // Ensure context is running if it was suspended (e.g., on first click)
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                if (audioContext.state === 'suspended') {
                    audioContext.resume();
                }
                audioReady = true;
                // Once initialized/resumed, remove the listener
                document.body.removeEventListener('click', initAudioContext, { once: true });
                document.body.removeEventListener('touchend', initAudioContext, { once: true });
                
            } catch (e) {
                console.warn('Web Audio API not supported or error during initialization:', e);
            }
        }
    }

    // Attach listener for first click/tap to resume AudioContext
    document.addEventListener('DOMContentLoaded', function() {
        document.body.addEventListener('click', initAudioContext, { once: true });
        document.body.addEventListener('touchend', initAudioContext, { once: true });
        syncCustomerInfo(); 
        fetchMenuDataAndRender(); // Fetch dynamic menu items on load
    });


    function playSound() {
        // We only attempt to play sound if initialization has run
        if (audioReady && audioContext && audioContext.state === 'running') {
            try {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 700; // Slightly lower frequency for clear notification
                oscillator.type = 'sine';
                
                // Quick attack and decay
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.2, audioContext.currentTime + 0.01);
                gainNode.gain.linearRampToValueAtTime(0.0001, audioContext.currentTime + 0.15);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.15);
            } catch (error) {
                console.error("Audio playback error:", error);
            }
        } else {
            console.log("AudioContext not ready or running.");
            // Try initializing one more time if a click occurred but context wasn't running
            initAudioContext();
        }
    }

    function showToast() {
      const toast = document.getElementById('toast');
      toast.classList.remove('show'); // Reset animation
      void toast.offsetWidth; // Trigger reflow
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // --- Core Add to Cart Function ---
    function addToCart(itemName, price) {
      playSound();
      showToast();
      
      if (cart[itemName]) {
        cart[itemName].quantity += 1;
      } else {
        cart[itemName] = { price: price, quantity: 1 };
      }
      updateCartDisplay();
    }
    // ---------------------------------
    
    function removeFromCart(itemName) {
      if (cart[itemName] && cart[itemName].quantity > 1) {
        cart[itemName].quantity -= 1;
      } else {
        delete cart[itemName];
      }
      updateCartDisplay();
    }

    function increaseQuantity(itemName) {
      playSound();
      if (cart[itemName]) {
        cart[itemName].quantity += 1;
        updateCartDisplay();
      }
    }


    // --- Location Modal Logic ---
    function toggleLocationModal() {
        const modal = document.getElementById('locationModal');

        if (modal.classList.contains('active')) {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        } else {
            // Sync current main data to the modal controls when opening
            const currentHotel = document.getElementById('hotelName').value;
            const currentContact = document.getElementById('contactNumber').value;
            // The tableNumber on the main page is repurposed to store the Hostel Name for delivery
            const currentTable = document.getElementById('tableNumber').value; 

            document.getElementById('hostelNameSelector').value = currentHotel;
            document.getElementById('contactNumberLocation').value = currentContact;
            // Removed roomNumberLocation sync
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
    }

    function confirmDeliveryLocation() {
        const selectedHotel = document.getElementById('hostelNameSelector').value;
        const selectedContact = document.getElementById('contactNumberLocation').value.trim();
        const isDelivery = selectedHotel !== 'Table Order';
        
        let validationError = null;

        if (isDelivery && (!selectedContact || selectedContact.length !== 10 || isNaN(selectedContact))) {
            validationError = 'Please enter a valid 10-digit Contact Number for delivery!';
        } else if (!isDelivery && !document.getElementById('tableNumber').value.trim()) {
             // For dine-in, ensure the main tableNumber field has a value
             validationError = 'Please enter your Table Number!';
        }
        
        if (validationError) {
            alert('Error: ' + validationError);
            return;
        }

        // 1. Update main page hidden fields
        document.getElementById('hotelName').value = selectedHotel;
        // If it's a delivery, set the 'tableNumber' field to the selected Hostel Name
        document.getElementById('tableNumber').value = isDelivery ? selectedHotel : ''; 
        document.getElementById('contactNumber').value = isDelivery ? selectedContact : '';

        // 2. Update button text and class
        const btn = document.getElementById('setDeliveryLocationBtn');
        if (isDelivery) {
            btn.textContent = `Delivery: ${selectedHotel}`;
            btn.classList.add('selected');
        } else {
            btn.textContent = 'Set Delivery Location';
            btn.classList.remove('selected');
        }

        // 3. Sync and close modal
        syncCustomerInfo();
        toggleLocationModal();
    }
    
    // --- Synchronization & UI Functions ---

    function toggleContactInput() {
        const hotelName = document.getElementById('hotelName').value;
        const contactGroup = document.getElementById('contactGroupMain');
        const tableRoomLabel = document.getElementById('tableRoomLabel');
        const isDeliveryOrder = hotelName && hotelName !== 'Table Order';
        const tableInput = document.getElementById('tableNumber');

        if (isDeliveryOrder) {
            contactGroup.classList.add('show');
            tableRoomLabel.textContent = 'Hostel Name:'; // Change label for delivery
            tableInput.placeholder = 'Hostel Name (Auto-set)';
            // For delivery, the input should show the selected hostel and be disabled/readonly 
            // The actual hostel name is in hotelName, but for simplicity we keep it in tableNumber to pass to API
            tableInput.readOnly = true; 
            tableInput.value = hotelName;
        } else {
            contactGroup.classList.remove('show');
            tableRoomLabel.textContent = 'Table Number:'; // Change label back for dine-in
            tableInput.placeholder = 'Enter Table Number';
            tableInput.readOnly = false;
        }
        updateCartDisplay(); 
    }

    function toggleContactInputModal() {
        const hotelNameModal = document.getElementById('hotelNameModal').value;
        const contactGroupModal = document.getElementById('contactGroupModal');
        const tableRoomLabelModal = document.getElementById('tableRoomLabelModal');
        const isDeliveryOrder = hotelNameModal && hotelNameModal !== 'Table Order';

        if (isDeliveryOrder) {
            contactGroupModal.classList.add('show');
            tableRoomLabelModal.textContent = 'Hostel Name:';
        } else {
            contactGroupModal.classList.remove('show');
            tableRoomLabelModal.textContent = 'Table Number:';
        }
    }

    function syncCustomerInfo() {
      const hotel = document.getElementById('hotelName').value;
      const table = document.getElementById('tableNumber').value;
      const contact = document.getElementById('contactNumber').value;

      // Sync Main Page inputs to Cart Modal hidden inputs (Source of Truth)
      document.getElementById('hotelNameModal').value = hotel;
      document.getElementById('tableNumberModal').value = table;
      document.getElementById('contactNumberModal').value = contact;
      
      // Sync Modal hidden inputs to Cart Modal display inputs (Readonly)
      document.getElementById('locationDisplayInCart').value = hotel;
      document.getElementById('tableNumberDisplayInCart').value = table;
      document.getElementById('contactNumberDisplayInCart').value = contact;

      // Re-apply visual updates based on new state
      toggleContactInput(); // Update main contact/table visibility
      toggleContactInputModal(); // Update modal contact/table visibility
      updateCartDisplay();
    }

    function syncCustomerInfoFromModal() {
        // Function called to ensure UI reflects hidden values in cart modal
        toggleContactInput(); 
        toggleContactInputModal(); 
        updateCartDisplay();
    }
    
    document.getElementById('tableNumber').addEventListener('input', syncCustomerInfo);
    document.getElementById('contactNumber').addEventListener('input', syncCustomerInfo);


    
    // --- Cart Display and Order Logic ---
    
    function updateCartDisplay() {
      const cartItemsDiv = document.getElementById('cartItemsList');
      const cartTotalDiv = document.getElementById('cartTotal');
      const cartBadge = document.getElementById('cartBadge');
      const deliveryRow = document.getElementById('deliveryChargeRow');
      // Read from hidden modal fields (Source of Truth for Cart/Order logic)
      const hotelName = document.getElementById('hotelNameModal').value;
      
      cartItemsDiv.innerHTML = '';
      total = 0;
      let totalItems = 0;

      const isDeliveryOrder = hotelName && hotelName !== 'Table Order';
      
      for (let item in cart) {
          const itemTotal = cart[item].price * cart[item].quantity;
          total += itemTotal;
          totalItems += cart[item].quantity;
          
          const cartItemDiv = document.createElement('div');
          cartItemDiv.className = 'cart-item';
          cartItemDiv.innerHTML = `
            <span>${item} (‚Çπ${cart[item].price})</span>
            <div class="quantity-controls">
              <button class="quantity-btn" onclick="removeFromCart('${item}')">‚àí</button>
              <span>${cart[item].quantity}</span>
              <button class="quantity-btn plus" onclick="increaseQuantity('${item}')">+</button>
              <span>‚Çπ${itemTotal}</span>
            </div>
          `;
          cartItemsDiv.appendChild(cartItemDiv);
      }

      let finalTotal = total;
      if (isDeliveryOrder && totalItems > 0) {
          deliveryRow.style.display = 'flex';
          finalTotal += DELIVERY_CHARGE;
      } else {
          deliveryRow.style.display = 'none';
      }

      if (Object.keys(cart).length === 0) {
        cartItemsDiv.innerHTML = `
          <div class="empty-cart">
            <div class="empty-cart-icon">üõí</div>
            <p>Your cart is empty</p>
            <p style="font-size: 0.9rem; margin-top: 5px;">Add items to get started!</p>
          </div>
        `;
        cartBadge.textContent = '0';
        deliveryRow.style.display = 'none'; 
      } else {
        cartBadge.textContent = totalItems;
      }

      cartTotalDiv.textContent = `Grand Total: ${finalTotal}`;
    }


    function toggleCart() {
      const modal = document.getElementById('cartModal');
      modal.classList.toggle('active');
      if (modal.classList.contains('active')) {
        syncCustomerInfo();
        document.body.style.overflow = 'hidden';
      } else {
        document.body.style.overflow = 'auto';
      }
    }
    
    function showStatusMessage(message, isError = false) {
      const statusDiv = document.getElementById('statusMessage');
      statusDiv.innerHTML = `<div class="status-message ${isError ? 'error' : 'success'}">${message}</div>`;
      
      setTimeout(() => {
        statusDiv.innerHTML = '';
      }, 5000);
    }


    function sendSMS() {
        syncCustomerInfoFromModal();
        const hotelName = document.getElementById('hotelNameModal').value; // Hostel Name or "Table Order"
        const tableNumber = document.getElementById('tableNumberModal').value.trim(); // Hostel Name or Table Number
        const contactNumber = document.getElementById('contactNumberModal').value.trim();
        const isDeliveryOrder = hotelName && hotelName !== 'Table Order';
        
        let validationError = null;

        if (Object.keys(cart).length === 0) {
            validationError = 'Please add items to cart!';
        } else if (isDeliveryOrder && (!contactNumber || contactNumber.length !== 10 || isNaN(contactNumber))) {
            validationError = 'Please enter a valid 10-digit Contact Number for delivery!';
        } else if (hotelName === 'Table Order' && tableNumber.length < 1) {
            validationError = 'Please enter your Table Number!';
        }

        if (validationError) {
            showStatusMessage(validationError, true);
            return;
        }

        const orderItems = Object.keys(cart).map(item => ({
            name: item,
            quantity: cart[item].quantity,
            price: cart[item].price,
            total: cart[item].price * cart[item].quantity
        }));
        
        let orderTotal = orderItems.reduce((sum, item) => sum + item.total, 0);
        
        if (isDeliveryOrder) {
            orderTotal += DELIVERY_CHARGE;
            orderItems.push({
                name: 'Delivery Charge',
                quantity: 1,
                price: DELIVERY_CHARGE,
                total: DELIVERY_CHARGE
            });
        }

        const newOrderData = {
            customerName: hotelName,
            tableNumber: tableNumber, // This now holds Hostel Name for delivery or Table No for dine-in
            contactNumber: isDeliveryOrder ? contactNumber : 'N/A',
            items: orderItems,
            total: orderTotal,
            type: isDeliveryOrder ? 'Delivery' : 'Dine-In',
            confirmed: false, 
            date: new Date().toLocaleDateString('en-GB'),
            time: new Date().toLocaleTimeString(),
            timestamp: Date.now()
        };
        
        // This fetch call is for demonstration, assuming the API works.
        fetch('https://mrt-cafe-api.onrender.com/api/orders', { 
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(newOrderData),
        })
        .then(response => {
            if (!response.ok) {
                return response.json().then(err => { throw new Error(err.message || 'Server error while placing order.'); });
            }
            return response.json();
        })
        .then(data => {
            showStatusMessage('‚úÖ Order Placed Successfully! (Order ID: ' + data.orderNumber + ')');
            
            cart = {};
            total = 0;
            
            // Reset customer info back to default
            document.getElementById('hotelName').value = 'Table Order';
            document.getElementById('tableNumber').value = '';
            document.getElementById('contactNumber').value = '';
            document.getElementById('setDeliveryLocationBtn').textContent = 'Set Delivery Location';
            document.getElementById('setDeliveryLocationBtn').classList.remove('selected');
            
            updateCartDisplay();
            syncCustomerInfo(); // Re-sync and update UI after reset
            toggleCart();

        })
        .catch(error => {
            console.error('Order Error:', error);
            showStatusMessage('‚ùå Order failed: ' + error.message, true);
        });
    }

    function downloadPDF() {
      syncCustomerInfoFromModal();
      const hotelName = document.getElementById('hotelNameModal').value;
      const tableNumber = document.getElementById('tableNumberModal').value; // Hostel Name or Table Number
      const contactNumber = document.getElementById('contactNumberModal').value;
      const isDeliveryOrder = hotelName && hotelName !== 'Table Order';

      if (Object.keys(cart).length === 0) {
        showStatusMessage('Cart is empty! Please add items first.', true);
        return;
      }
      
      let validationError = null;
      if (isDeliveryOrder && (!contactNumber || contactNumber.length !== 10 || isNaN(contactNumber))) {
            validationError = 'Please enter a valid 10-digit Contact Number for delivery!';
        } else if (hotelName === 'Table Order' && tableNumber.length < 1) {
            validationError = 'Please enter your Table Number!';
        }
        
        if (validationError) {
            showStatusMessage(validationError, true);
            return;
        }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      let currentTotal = Object.values(cart).reduce((sum, item) => sum + (item.price * item.quantity), 0);
      let finalTotal = currentTotal;
      
      const locationLabel = isDeliveryOrder ? 'Hostel Name' : 'Table Number';
      const locationValue = tableNumber;

      doc.setFontSize(20);
      doc.setTextColor(40, 40, 40);
      doc.text('MR.T Cafe - Food Order Bill', 105, 20, { align: 'center' });

      doc.setFontSize(12);
      doc.text(`Location Type: ${hotelName === 'Table Order' ? 'Dine-In' : 'For Delivery'}`, 20, 40);
      doc.text(`${locationLabel}: ${locationValue}`, 20, 50);
      
      let currentY = 60;
      if (isDeliveryOrder) {
        doc.text(`Contact No.: ${contactNumber}`, 20, currentY);
        currentY += 10;
      }
      
      doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, currentY + 10);
      doc.text(`Time: ${new Date().toLocaleTimeString()}`, 20, currentY + 20);
      
      let startY = currentY + 30;

      const tableData = [];
      for (let item in cart) {
        tableData.push([
          item,
          cart[item].quantity.toString(),
          `${cart[item].price}`,
          `${cart[item].price * cart[item].quantity}`
        ]);
      }
      
      if (isDeliveryOrder) {
        tableData.push([
          'Delivery Charge',
          '1',
          `${DELIVERY_CHARGE}`,
          `${DELIVERY_CHARGE}`
        ]);
        finalTotal += DELIVERY_CHARGE;
      }

      doc.autoTable({
        head: [['Item', 'Qty', 'Price', 'Total']],
        body: tableData,
        startY: startY,
        theme: 'grid',
        headStyles: { fillColor: [102, 126, 234] }
      });

      const finalY = doc.lastAutoTable.finalY + 10;
      doc.setFontSize(14);
      doc.setFont(undefined, 'bold');
      doc.text(`Grand Total: ${finalTotal}`, doc.internal.pageSize.width - 10, finalY, { align: 'right' });

      doc.setFontSize(10);
      doc.setFont(undefined, 'normal');
      doc.text('Thank you for your order!', 105, finalY + 20, { align: 'center' });

      doc.save(`MRT_Cafe_Order_${hotelName}_${Date.now()}.pdf`);
      showStatusMessage('‚úÖ PDF downloaded successfully!');
    }

    // Close modal when clicking outside
    document.getElementById('cartModal').addEventListener('click', function(e) {
      if (e.target.id === 'cartModal') {
        toggleCart();
      }
    });
    
    document.getElementById('locationModal').addEventListener('click', function(e) {
      if (e.target.id === 'locationModal') {
        toggleLocationModal();
      }
    });
    
    // Search functions (kept unchanged as they were working)
    
    const searchInput = document.getElementById('searchInput');
    const clearSearchBtn = document.getElementById('clearSearch');
    const searchResultsInfo = document.getElementById('searchResultsInfo');

    searchInput.addEventListener('input', function() {
      const searchTerm = this.value.toLowerCase().trim();
      
      if (searchTerm.length > 0) {
        clearSearchBtn.classList.add('show');
        performSearch(searchTerm);
      } else {
        clearSearchBtn.classList.remove('show');
        clearSearch();
      }
    });

    function performSearch(searchTerm) {
      const categories = document.querySelectorAll('.category');
      let foundCount = 0;
      let searchResults = [];

      categories.forEach(category => {
        const categoryTitle = category.querySelector('h2').textContent.toLowerCase();
        const items = category.querySelectorAll('.item');
        let categoryHasMatch = false;

        items.forEach(item => {
          const itemName = item.querySelector('.item-name').textContent.toLowerCase();
          
          if (itemName.includes(searchTerm) || categoryTitle.includes(searchTerm)) {
            item.classList.remove('hidden');
            item.classList.add('highlight');
            categoryHasMatch = true;
            foundCount++;
            
            searchResults.push({
              item: item,
              category: category,
              categoryTitle: categoryTitle,
              itemName: itemName
            });
          } else {
            item.classList.add('hidden');
            item.classList.remove('highlight');
          }
        });

        if (categoryHasMatch) {
          category.classList.remove('hidden');
        } else {
          category.classList.add('hidden');
        }
      });

      const searchContainer = document.querySelector('.search-container');
      
      const resultsByCategory = {};
      searchResults.forEach(result => {
        const catTitle = result.categoryTitle;
        if (!resultsByCategory[catTitle]) {
          resultsByCategory[catTitle] = {
            category: result.category,
            items: []
          };
        }
        resultsByCategory[catTitle].items.push(result.item);
      });

      const allCategories = Array.from(categories);
      const matchingCategories = [];

      allCategories.forEach(cat => {
        const catTitle = cat.querySelector('h2').textContent.toLowerCase();
        if (resultsByCategory[catTitle]) {
          matchingCategories.push(cat);
          
          const h2 = cat.querySelector('h2');
          const matchingItems = resultsByCategory[catTitle].items;
          
          matchingItems.forEach(item => {
            h2.insertAdjacentElement('afterend', item);
          });
        }
      });

      matchingCategories.forEach(cat => {
        searchContainer.insertAdjacentElement('afterend', cat);
      });

      if (foundCount > 0) {
        searchResultsInfo.textContent = `Found ${foundCount} item${foundCount > 1 ? 's' : ''} matching "${searchTerm}"`;
      } else {
        searchResultsInfo.textContent = `No items found matching "${searchTerm}"`;
      }
    }

    function clearSearch() {
      searchInput.value = '';
      clearSearchBtn.classList.remove('show');
      searchResultsInfo.textContent = '';

      const categories = document.querySelectorAll('.category');
      
      categories.forEach(category => {
        category.classList.remove('hidden');
        const items = category.querySelectorAll('.item');
        items.forEach(item => {
          item.classList.remove('hidden', 'highlight');
        });
      });

      const categoriesArray = Array.from(categories);
      categoriesArray.forEach(cat => {
        document.body.appendChild(cat);
      });
    }

  </script>
</body>
</html>





